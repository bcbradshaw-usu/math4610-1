<!DOCTYPE html>
<html>

<head>
  <title> Math 4610 Fundamentals of Computational Mathematics Homework </title>
  <link href="homework.css" rel="stylesheet" type="text/css" />
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript" async
    src="https://example.com/MathJax.js?config=TeX-AMS_CHTML">
  </script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>
<body>

<hr>

<h1> Math 4610 Fundamentals of Computational Mathematics  - Topic 14.  </h1>

<hr>

In this section we will analyze approximations of derivatives using various
difference quotients. Recall that the derivative of a function \(f(x)\) exists
if the following limit exists.
\[
  f'(a) = {{df}\over{dx}}(a) = \lim_{h\rightarrow 0}\ {{f(a+h)-f(a)}\over{h}}
\]
We can then turn around and use the approximation
\[
  f'(a) \approx {{f(a+h)-f(a)}\over{h}}
\]
There are at least a couple of questions that we should want the answers to.
First, how accurate is the approximation? Another question to answer might be
are there better approximations we can be developed?

To complete the analysis in this section we won't need a computer. Instead we
will resort to the standard tool of Taylor series expansions.

<hr>

<h2> Some Useful Taylor Series Expansions: </h2>

<hr>

In this section several expansions will be determined that will be used below in
the development of various difference quotients.

<hr>

<h2> Approximation To the Left Side: </h2>

<hr>

If \(f(a+h)\) is a part of any difference quotient, we can write an expansion
for \(f\) at \(a\) as follows.
\[
  f(a+h) = f(a) + h\ f'(a) + {1\over 2}\ h^2 f''(a) + {1\over 6} h^3 f'''(a)
               + \cdots
\]
On the other hand, we can write
\[
  f(a-h) = f(a) - h\ f'(a) + {1\over 2}\ h^2 f''(a) - {1\over 6} h^3 f'''(a)
               + \cdots
\]
Note that the expansion of \(f(a)\) is simply itself, \(f(a)=f(a)\). Typically,
we will look to expand all terms about the same point, \(a\). It should be noted
that \(a\pm h\) must both reside in the same open interval containing the point
\(a\).

We can continue in this manner to write expansions at \(a\pm 2h\).
\[
  f(a+2h) = f(a) + 2h\ f'(a) + 2h^2 f''(a) + {4\over 3} h^3 f'''(a) + \cdots
\]
and
\[
  f(a-2h) = f(a) - 2h\ f'(a) + 2h^2 f''(a) - {4\over 3} h^3 f'''(a) + \cdots
\]
to expand the function at a point a distance of \(2h\) away. It is not hard to
imagine using more and more values.

As a simple example, consider the approximation of \(f'(a)\) using a one-sided
difference of the form
\[
  f'(a) \approx {{f(a)-f(a-h)}\over{h}}
\]
We will expand everything on the right hand side of the approximation at the
same point, \(a\). Using the expansions above we can write
\begin{eqnarray*}
  {{f(a)-f(a-h)}\over{h}} & = & {1\over h} \left( f(a)-f(a-h) \right) \\
       & = & {1\over h}
        \left( f(a)-( f(a) - h f'(a)
               + {1\over 2} h^2 f''(a) - \cdots ) \right) \\
       & = & {1\over h}
        \left( h f'(a) - {1\over 2} h^2 f''(a) + \cdots \right) \\
       & = & f'(a) - {1\over 2} h f''(a) + \cdots 
\end{eqnarray*}
As mentioned in the last topic, this can be interpreted as follows. The
one-sided difference quotient used in this example is equal to \(f'(a)\) plus
an infinite number of terms from the Taylor series expansion about \(a\).

We can actually be a bit more precise in the estimation of these quantities. The
Taylor series with remainder will do the trick.

<hr>

<h2> Using the Taylor Series with Remainder </h2>

<hr>

Using the Taylor series with remainder we can write
\[
  f(a-h) = f(a) - h\ f'(a) + {1\over 2}\ h^2 f''(\xi)
\]
where \(\xi\) is between \(a\) and \(a-h\). The difference is that the expansion
now has a finite number of terms. Performing the same analysis as above we can
write
\[
  {{f(a)-f(a-h)}\over{h}} = f'(a) - {1\over 2} h f''(\xi)
\]
As long as the function, \(f(x)\), has two continuous derivatives, we can bound
the remainder term and as \(h\rightarrow 0\) the remainder term will approach
zero. Now, the statement is that the difference quotient is equal to \(f'(a)\)
plus an error term that goes to zero as \(h\) goes to zero.

Note that all of this agrees with what students are taught in a calculus course.

<hr>

<h2> Writing The Expansions As An Error: </h2>

<hr>

Another way to write the expansions and such is to use an error form for the
equation. For the example in the last section, we can write
\[
  | {{f(a)-f(a-h)}\over{h}} - f'(a) | = | {1\over 2} h f''(\xi) |
\]
This is a more accurate statement of what we are after. That is, what is the
error in using the difference quotient as an approximation of the derivative?

If \(|f(x)|\) is continuous in an interval around \(a\), then there is a
positive constant, \(B>0\), such that
\[
  |f''(\xi)| \leq B
\]
and thus we can write the error as
\[
  | {{f(a)-f(a-h)}\over{h}} - f'(a) | = | {1\over 2} h f''(\xi) |
         \leq {B\over 2} h \leq Ch
\]
where \(C=B/2\). For this sort of result, we would say that the approximation
linearly converges to the derivative, \(f'(a)\) as \(h\) approaches zero.

<hr>

<h2> Order of Accuracy in an Approximation: </h2>

<hr>

In the previous section, the error in the difference quotient approximation
satisfied the bound
\[
  E_1 = | {{f(a)-f(a-h)}\over{h}} - f'(a) | \leq C h 
\]
In general, we can write these types of approximations in the form
\[
  E \leq C h^r
\]
where \(r>0\). For the approximation in the previous section, \(r=1\). For the
general formula above, \(r\), is called the order of convergence or the order of
the approximation. If \(r=1\) the approximation is said to be linear or give
linear convergence and if \(r=2\), the approximation is said to converge
quadratically.

<hr>

<h2> A Better Approximation Using a Centered Difference Quotient: </h2>

<hr>

The derivative can also be approximated by a central difference,
\[
  f'(a) \approx {{f(a+h)-f(a-h)}\over{2h}}
\]
To determine the error in this approximation we will expand the function values
in the numerator of the difference quotient. Using the expansions above, the
difference quotient becomes
\begin{eqnarray*}
  {{f(a+h)-f(a-h)}\over{2h}}
     & = & {1\over{2h}} \left( f(a+h) - f(a-h) \right) \\
     & = & {1\over{2h}}
       \left(
         f(a) + h f'(a) + {1\over 2} h^2 f''(a) + {1\over 6} h^3 f'''(\xi)
        - ( f(a) - h f'(a) + {1\over 2} h^2 f''(a) - {1\over 6} h^3 f'''(\eta))
       \right) \\
     & = & {1\over{2h}}
       \left(
         h f'(a) + {1\over 6} h^3 f'''(\xi)
       + h f'(a) + {1\over 6} h^3 f'''(\eta))
       \right) \\
     & = & {1\over{2h}}
       \left(
         2 h f'(a) + {1\over 6} h^3 ( f'''(\xi) + f'''(\eta) )
       \right) \\
     & = & f'(a) + {1\over 6} h^2 ( f'''(\xi) + f'''(\eta) )
\end{eqnarray*}
Notice the two different points, \(\xi\), that resides somewhere between \(a\)
and \(a+h\) and, \(eta\), that resides between \(a\) and \(a-h\). Now, using an
application of the mean value theorem for derivatives, we can write
\[
  {{f(a+h)-f(a-h)}\over{2h}} = f'(a) + {1\over 6} h^2 f'''(\gamma)
\]
So, if the function has three continuous derivatives near the point \(a\) then
we can write an error formula as follows.
\[
  E_2 = | {{f(a)-f(a-h)}\over{h}} - f'(a) | \leq C h^2 
\]
where the constant \(C\) depends on \(f'''(x)\). This method is a quadratic
method of approximating the derivative of a function since \(r=2\).

Now to a comparison: If \(h=0.01=10^{-2}\), then
\[
  E_1 \leq C 10^{-2}
\]
for the first approximation and for the central difference
\[
  E_2 \leq C (10^{-2})^2 = C 10^{-4}
\]
Comparing these expressions, it is clear that the central difference
approximation is much better for the same value of the increment, \(h\). So,
there is at least one approximation that is better than the first approximation
we tried.

<hr>

<h2> Using Linear Combinations to Compute Higher Order Approximations: </h2>

<hr>

The last question is can we increase the order of accuracy to whatever level we
would like - at least theoretically. The answer is yes. If we consider the forms
for the difference quotients, we can treat the difference quotients as linear
combinations of function values near the point of interest, \(a\). The central
difference approximation can be written as
\[
  f'(a) = {1\over{2h}} f(a+h) - {1\over{2h}} f(a-h)
          = a_1 f(a+h) + a_{-1} f(a-h)
\]
where \(a_1=1/2h\) and \(a_{-1}=-1/2h\). This is just a linear combination of
function values are points near \(a\).

Maybe we can do better. Let's try a bit more general linear combination. That
is, consider the approximation
\[
  f'(a) \approx a_{-2} f(a-2h) + a_{-1} f(a-h) + a_0 f(a) + a_1 f(a+h)
              + a_2 f(a+2h)
\]
This leaves us with five coefficients that can be used to determine
approximation.

We can substitute the expansions found earlier to start the work.
\begin{eqnarray*}
  f'(a) & \approx & a_{-2} \left( f(a) - 2h\ f'(a) + 2h^2 f''(a)
                      - {4\over 3} h^3 f'''(a) + \cdots \right) \\
         & &          + a_{-1} \left( f(a) - h\ f'(a) + {1\over 2}\ h^2 f''(a)
                      - {1\over 6} h^3 f'''(a) + \cdots \right) \\
         & &          + a_0 f(a) \\
         & &          + a_1 \left( f(a) + h\ f'(a) + {1\over 2}\ h^2 f''(a)
                      + {1\over 6} h^3 f'''(a) + \cdots \right) \\
         & &          + a_2 \left( f(a) + 2h\ f'(a) + 2h^2 f''(a)
                      + {4\over 3} h^3 f'''(a) + \cdots \right)
\end{eqnarray*}
This is a bit messy, put should make sense. The next trick is to rearrange and
factor out terms that involve \(f(a)\), \(f'(a)\), and so on to obtain the
following expression.
\begin{eqnarray*}
  f'(a) & \approx & \left( a_{-2} + a_{-1} + a_0 + a_1 + a_2 \right) f(a) \\
        & & + h\ \left( -2 a_{-2} - a_{-1} + a_1 + 2 a_2 \right) f'(a) \\
        & & + h^2\ \left( 2 a_{-2} + {1\over 2} a_{-1}
                      + {1\over 2} a_1 + 2 a_2 \right) f''(a) \\
        & & + h^3\ \left( - {4\over 3} a_{-2} - {1\over 6} a_{-1}
                       + {1\over 6} a_1 + {4\over 3} a_2 \right) f'''(a) \\
        & & + h^4\ \left( {2\over 3} a_{-2} + {1\over 24} a_{-1}
                  + {1\over 24} a_1 + {2\over 3} a_2 \right) f^{iv}) + \cdots
\end{eqnarray*}
Note that we have not accounted for the continuation "\(\cdots\)" in the
expression above. With some work (maybe in a homework problem) one will find
that smallest possible error for this finite difference approximation is
defined by
\[
  | f'(a) - a_{-2} f(a-2h) + a_{-1} f(a-h) + a_0 f(a) + a_1 f(a+h)
              + a_2 f(a+2h) | \leq C\ h^4
\]
However, we still need to determine the values of the constants.

What do we want from the approximation? On the left hand side, we have \(f'(a)\)
and on the right hand side, we want the same. So, the term involving \(f(a)\)
must be zero. That means
\[
  a_{-2} + a_{-1} + a_0 + a_1 + a_2 = 0
\]
The next term involves \(f'(a)\), so this means that
\[
  f'(a) = h\ \left( -2 a_{-2} - a_{-1} + a_1 + 2 a_2 \right) f'(a)
\]
or
\[
  -2 a_{-2} - a_{-1} + a_1 + a_2 = {1\over h}
\]
The third term involves \(f''(a)\) and must be zero since we are approximating
the first derivative. This yields
\[
   2 a_{-2} + {1\over 2} a_{-1} + {1\over 2} a_1 + 2 a_2 = 0
\]
We continue this until we have enough equations to uniquely determine
coefficients \(a_{-2}\), \(a_{-1}\), \(a_0\), \(a_1\), and \(a_2\). Including
the last two conditions, we end up with a linear system of equations of the
form
\begin{eqnarray*}
  a_{-2} + a_{-1} + a_0 + a_1 + a_2 & = & 0 \\
     -2 a_{-2} - a_{-1} + a_1 + a_2 & = & {1\over h} \\
   2 a_{-2} + {1\over 2} a_{-1} + {1\over 2} a_1 + 2 a_2
                                    & = & 0 \\
- {4\over 3} a_{-2} - {1\over 6} a_{-1} + {1\over 6} a_1
                                        + {4\over 3} a_2
                                    & = & 0 \\
   {2\over 3} a_{-2} + {1\over 24} a_{-1} + {1\over 24} a_1 + {2\over 3} a_2
                                    & = & 0 
\end{eqnarray*}
The result is a linear system of equations for the coefficients. The system
involves five equations in five unknowns. We could solve this by brute force
using Gaussian elimination and backsubstitution. The top of solving linear
systems of equations will be treated later in the semester. We will write code
to take care of systems like this.

Instead, we can go grab the solution off the internet. One source for the
solution is
<a href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">
  Wikipedia
</a>
Near the top of this page there is a table of coefficients for central
difference approximations of various derivatives. The coefficients we will need
are in the first section with accuracy of 4. We can read these off as
\[
  a_{-2}={1\over{12h}},\ \ \ a_{-1}=-{2\over{3h}}, \ \ \ a_0=0,
         \ \ \ a_1={2\over{3h}}, \ \ \ a_2=-{1\over{12h}}
\]
Note that the values in the table do not include the increment. The division by
\(h\) is needed to justify the solution on
<a href="https://en.wikipedia.org/wiki/Finite_difference_coefficient">
  Wikipedia
</a>
and the work we have done in this section.

What we can say is the approximation
\begin{eqnarray*}
  f'(a) & \approx &
     {1\over h} \left(
       {1\over{12}} f(a-2h) - {2\over 3} f(a-h) + {2\over 3} f(a+h)
              - {1\over{12}} f(a+2h)
                \right) \\
        & = & 
     {1\over{3h}} \left(
       {1\over 4} f(a-2h) - 2 f(a-h) + 2 f(a+h) - {1\over 4} f(a+2h)
                \right)
\end{eqnarray*}
provides a \(4^{th}\)-order approximation of the first derivative.

<hr>

  <a href="../../topic_13/html/topic_13.html"> Previous </a>
   &nbsp;&nbsp; | &nbsp;&nbsp;
  <a href="../../toc/md/topic_toc.md"> Table of Contents  </a>
   &nbsp;&nbsp; | &nbsp;&nbsp;
  <a href="../../topic_15/html/topic_15.html"> Next </a>

<hr>

</body>
</html>
