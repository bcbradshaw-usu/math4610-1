\documentclass[10pt,fleqn]{article}
%\usepackage{graphicx}


\setlength{\topmargin}{-.75in}
\addtolength{\textheight}{2.00in}
\setlength{\oddsidemargin}{.00in}
\addtolength{\textwidth}{.75in}

\title{Math 4610 Lecture Notes \\
            \ \\
            How to Build a Jar File for Java Objects
  \footnote{These notes are part of an Open Resource Educational project
            sponsored by Utah State University}}

\author{Joe Koebbe}

\nofiles

\pagestyle{empty}

\setlength{\parindent}{0in}

\input{/cygdrive/m/tex/commands/commands}

\begin{document}
\maketitle
\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vskip0.1in\hrule\vskip0.1in
\noindent
{\bf Steps for Building a Shared Library:}
\vskip0.1in\hrule\vskip0.1in
\noindent
Like shared libraries that contain some number of object files, a jar file can
be used to collect class files that are generated by compiling java code. This
set of notes will cover how to create jar files that collect class files. In
addition, we will see how to extract and use a subset of the class files for
applications and to attach to other java codes.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vskip0.1in\hrule\vskip0.1in
{\large{\bf Setting Things Up}}
\vskip0.1in\hrule\vskip0.1in
\noindent
To start, let's create a couple of java files that define simple objects that
return the absolute error and the relative error. It should be noted that this
may not be the best way to define these routines. However, we are after a simple
example so that the details of the jar file creation are not lost in the work in
this example.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vskip0.1in\hrule\vskip0.1in
{\large{\bf The Codes We Have:}}
\vskip0.1in\hrule\vskip0.1in
\noindent
The following code can be edited into a text file. The code below returns the
absolute error in using one number to approximate the other.
\vskip0.1in\hrule\vskip0.1in
\begin{verbatim}

    //
    // java object that computes and returns the absolute error in approximating
    // a real number, y, by another real number x
    //
    public class AbsError extends Object {
      public static double abserr(double x, double y) {
        return Math.abs(x-y);
      }
    }

\end{verbatim}
\vskip0.1in\hrule\vskip0.1in
\noindent
A second ocde for the relative error can be written that looks like the
following.
\vskip0.1in\hrule\vskip0.1in
\begin{verbatim}

    //
    // define the class for the absolute error object
    // ----------------------------------------------
    //
      public class RelError extends Object {
        public static double relerr(double x, double y) {
        return Math.abs((x-y)/x);
      }
    }

\end{verbatim}
\vskip0.1in\hrule\vskip0.1in
\noindent
So, let's create a folder under the main folder, say src. Do this in a
convenient as follows
\begin{verbatim}

    mkdir java
    cd java

\end{verbatim}
Create the files in the folder. You can either cut and paste the lines or type
them in. Next, compile the two files in the folder as follows:
\begin{verbatim}

    % javac *.java

\end{verbatim}
Note that the asterisk is a wildcard character which allows the command to
compile both files with a single command. In the setting of creating a location
for class files, there is one more file that is needed. The jar utility requires
the specification of an entry point into any jar file. The entry point can be
included in a manifest file that can be created by hand. 
\vskip0.1in\hrule\vskip0.1in
\noindent
For this example, we will create another java class that acts as a default
entry point for the library of classes in the jar file. So, create a new file
named ObjectInventroy.java using a text editor. Edit or copy in the lines
below.
\vskip0.1in\hrule\vskip0.1in
\begin{verbatim}

    //
    // define the class for the absolute error object
    // ----------------------------------------------
    //
    import java.io.*;
    public class ObjectInventory extends Object {
      public static void main(String args[]) {
        String s = "Use:\n\n"
                 + "    jar tf\n\n"
                 + "to see a list of the objects in the jar file. Use:\n\n"
                 + "    jar xf \n\n"
                 + "to extract the objects needed.\n\n";
        System.out.println(s);
      }
    }

\end{verbatim}
You will need to compile this file as part of the process. So, type the command
\begin{verbatim}

    % javac ObjectInventory.java

\end{verbatim}
This will place another class file in the folder. If you look at the object, all
it does is print out a message that documents how to use the jar file command to
access and extract class files.
\vskip0.1in\hrule\vskip0.1in
\noindent
The last thing to do is to define the entry point in a manifest file. So,
create/edit the manifest file for the jar file. The file must be named mainClass
in order to work. So, creat the file using
\begin{verbatim}

    % vim ObjectInventory.java

\end{verbatim}
and make the file look like the following.
\begin{verbatim}

    Main-Class: ObjectInventory

\end{verbatim}
Save this file and exit your text editor.
\vskip0.1in\hrule\vskip0.1in
\noindent
The final step is to create the jar file this is done using the following
command:
\begin{verbatim}

    % jar cfm MyJar.jar mainClass *.class

\end{verbatim}
The flags in the command are defined below:
\begin{verbatim}

    c - tells jar to create the jar file (named MyJar.jar above)
    f - the file name for the jar file (MyJar.jar)
    m - use the manifest or entry point defined in the mainClass file

\end{verbatim}
The last token in the command is the *.class which tells the jar command to
place all class files in the current folder in the jar file. To see what is in
a jar file use the following command:
\begin{verbatim}

    jar tf MyJar.jar

\end{verbatim}
In the simple example here the output looks like:
\begin{verbatim}

    META-INF/
    META-INF/MANIFEST.MF
    AbsError.class
    ObjectInventory.class
    RelError.class

\end{verbatim}
To execute a program inside a jar file, one specifies this using the following.
\begin{verbatim}

    % java -jar ./MyJar.jar

\end{verbatim}
The output from this command for this example is
\begin{verbatim}

    Use:

        jar tf

    to see a list of the objects in the jar file. Use:

        jar xf [object.class]

    to extract the objects needed.

\end{verbatim}





Add some stuff about removing and addition of objects from the jar file.




\vskip0.1in\hrule\vskip0.1in
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vskip0.1in\hrule\vskip0.1in
\noindent
In this example, there will be four files:
\vskip0.1in\hrule\vskip0.1in
\begin{list}{$\bullet$}{\usecounter{beans} \parsep=0pt \listparindent=0pt
\topsep=0pt \rightmargin=.35in \leftmargin=.35in \labelsep=5 pt
\itemsep=2pt}
  \item old\_main.f - all of the code is in one file
  \item main.f - just the main part of the code
  \item smaceps.f - this file contains the code to compute the machine epsilon
  \item abserr.f - the routine that computes the absolute error
\end{list}
\vskip0.1in\hrule\vskip0.1in
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
